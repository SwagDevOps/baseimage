#!/usr/bin/env ruby
# frozen_string_literal: true

# This script SHOULD be replaced by ylem "hooks" when availbale.

autoload(:Pathname, 'pathname')
autoload(:FileUtils, 'fileutils')
# rubocop:disable Style/MixinUsage
include(FileUtils::Verbose)
# rubocop:enable Style/MixinUsage

at_exit { GC.start }

Dir['/boot/{.[^\.]*,*}'].sort.tap do |paths|
  paths.map do |fp|
    Thread.new { rm_rf(fp) unless Pathname.new(fp).mountpoint? }
  end.map(&:join)
end
